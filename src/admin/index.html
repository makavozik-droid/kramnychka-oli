<!doctype html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Адмін — Крамничка Олі</title>
</head>
<body>
  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@latest/dist/decap-cms.js"></script>

  <script>
    (function () {
      if (!window.netlifyIdentity) return;

      window.netlifyIdentity.init();

      const hash = window.location.hash || "";

      // ✅ Лист-запрошення: встановити пароль
      if (hash.includes("invite_token")) {
        window.netlifyIdentity.open("signup");
      }

      // ✅ Лист відновлення: встановити НОВИЙ пароль (це саме те, що треба)
      if (hash.includes("recovery_token")) {
        window.netlifyIdentity.open("recovery");
      }

      // ✅ Підтвердження email (інколи приходить так)
      if (hash.includes("confirmation_token")) {
        window.netlifyIdentity.open("login");
      }

      // Після логіну лишаємось в /admin/
      window.netlifyIdentity.on("login", () => {
        window.location.replace("/admin/");
      });
    })();
  </script>
</body>
</html>
